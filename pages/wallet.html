<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto-Platform - Wallet</title>
    <script>
      (function() {
        try { 
          const savedTheme = localStorage.getItem('theme');
          const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          const theme = savedTheme || (prefersDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
          
          window.resetWallet = function() {
            localStorage.removeItem('wallet');
            alert('Wallet reset successful! Please refresh the page.');
            location.reload();
          };
        } catch (e) {
          console.warn('Could not apply theme from localStorage', e);
        }
      })();
    </script>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="css/wallet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <button id="resetWalletBtn" onclick="resetWallet()" style="position:fixed; bottom:5px; right:5px; opacity:0.1; z-index:9999; font-size:10px; padding:5px; background-color:red; color:white; border:none; border-radius:4px;">Reset Wallet</button>
    <nav class="navbar">
        <a href="../index.html" class="logo">Crypto-Platform</a>
        <button class="hamburger">
            <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links">
            <a href="news.html" class="nav-item">News</a>
            <a href="prices.html" class="nav-item">Prices</a>
            <a href="orionix.html" class="nav-item">Orionix</a>
            <a href="wallet.html" class="nav-item active">Wallet</a>
            <a href="trade.html" class="nav-item">Trade</a>

            <button id="themeToggleBtnMobile" class="theme-toggle-btn mobile">
                <i class="fas fa-moon"></i>
            </button>
        </div>
        <div class="controls-desktop">
            <button id="notificationBtn" class="notification-btn">
                <i class="fas fa-bell"></i>
            </button>
            <button id="themeToggleBtn" class="theme-toggle-btn">
                <i class="fas fa-moon"></i>
            </button>
            <div class="auth-buttons desktop" style="display:flex; gap:0.5rem;">
                <button id="loginBtn" class="auth-btn" onclick="window.location.href='login.html'">Login</button>
                <button id="signupBtn" class="auth-btn" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
            <div id="user-info-desktop" class="user-info-desktop" style="display:none; align-items:center; gap:10px;">
                <img id="user-photo-desktop" src="" alt="User Photo" style="width:32px;height:32px;border-radius:50%;object-fit:cover;display:none;">
                <span id="user-name-desktop" style="font-weight:600;"></span>
                <button id="logoutBtnDesktop" class="auth-btn" style="display:none;">Logout</button>
            </div>
        </div>
    </nav>

    <main class="wallet-container">
        <div class="about-title">
            <h2>Crypto Wallet</h2>
        </div>
        
        <div class="dashboard-section">
            <div class="balance-card">
                <div class="balance-header">
                    <h3>Total Balance</h3>
                    <div class="balance-actions">
                        <button class="view-btn" title="Toggle Balance Visibility" id="toggleBalanceBtn">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="balance-amount">
                    <span class="currency">$</span>
                    <span class="amount" id="balanceAmount">0.00</span>
                    <span class="amount hidden" id="hiddenBalance" style="display: none;">******</span>
                </div>
                <div class="balance-change positive">
                    <i class="fas fa-caret-up"></i>
                    <span>0.00%</span>
                    <span class="period">24h</span>
                </div>
                <div class="portfolio-chart">
                    <canvas id="portfolioChart"></canvas>
                </div>
            </div>
            
            <div class="quick-actions">
                <button class="action-button" id="depositButton">
                    <div class="action-icon deposit">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                    <span>Deposit</span>
                </button>
                <button class="action-button" id="withdrawButton">
                    <div class="action-icon withdraw">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                    <span>Withdraw</span>
                </button>
                <button class="action-button" id="swapButton">
                    <div class="action-icon swap">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <span>Swap</span>
                </button>
                <button class="action-button" id="tradeButton">
                    <div class="action-icon trade">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <span>Trade</span>
                </button>
            </div>
        </div>
        
        <div class="assets-section">
            <div class="section-header">
                <h3>Your Assets</h3>
            </div>
            
            <div class="assets-list" id="assetsList">
                <div class="no-assets-message">
                    <p>No assets yet. Make a deposit to add assets to your wallet.</p>
                </div>
            </div>
        </div>
        
        <div class="transactions-section">
            <div class="section-header">
                <h3>Recent Transactions</h3>
            </div>
            
            <div class="transactions-list" id="transactionsList">
                <div class="no-transactions-message">
                    <p>No transactions yet. Your transaction history will appear here.</p>
                </div>
            </div>
        </div>
    </main>

    <div id="depositModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Deposit Crypto</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form">
                    <div class="form-group">
                        <label for="depositCoin">Select Coin</label>
                        <div class="custom-dropdown">
                            <div class="selected-option" id="selectedCoin">
                                <img src="https://assets.coingecko.com/coins/images/1/small/bitcoin.png" alt="Bitcoin" class="coin-icon">
                                <span class="coin-name">Bitcoin (BTC)</span>
                                <i class="fas fa-chevron-down dropdown-arrow"></i>
                            </div>
                            <div class="dropdown-options" id="coinOptions">
                            </div>
                            <input type="hidden" id="depositCoin" value="btc">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="depositAmount">Amount</label>
                        <div class="input-with-symbol">
                            <input type="number" id="depositAmount" class="form-input" step="any" min="0" placeholder="0.00">
                            <span id="depositCoinSymbol" style="display: none;">BTC</span>
                        </div>
                    </div>
                    
                    <div class="transaction-preview-card">
                        <h4 class="preview-title">Transaction Summary</h4>
                        <div class="preview-content">
                            <div class="preview-row">
                                <span class="preview-label">You will receive:</span>
                                <span class="preview-value"><span id="previewAmount">0.00</span> <span id="previewSymbol">BTC</span></span>
                            </div>
                            <div class="preview-row">
                                <span class="preview-label">Estimated value:</span>
                                <span class="preview-value">$<span id="previewValue">0.00</span></span>
                            </div>
                            <div class="preview-row">
                                <span class="preview-label">Processing time:</span>
                                <span class="preview-value" id="processingTime">~10-60 minutes</span>
                            </div>
                        </div>
                    </div>
                    
                    <button id="depositSubmitBtn" class="submit-btn">Deposit Now</button>
                </div>
            </div>
        </div>
    </div>

    <div id="withdrawModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Withdraw Crypto</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form">
                    <div class="form-group">
                        <label for="withdrawCoin">Select Coin</label>
                        <select id="withdrawCoin" class="form-select">
                            <option value="btc">Bitcoin (BTC)</option>
                            <option value="eth">Ethereum (ETH)</option>
                            <option value="orx">Orionix (ORX)</option>
                        </select>
                    </div>
                    
                    <div class="form-group amount-input-group">
                        <label for="withdrawAmount">Amount</label>
                        <div class="input-with-max">
                            <input type="number" id="withdrawAmount" class="form-input" placeholder="0.00" min="0" step="any">
                            <button class="max-btn">MAX</button>
                        </div>
                        <div class="amount-details">
                            <span class="available">Available: <span id="availableAmount">0.00</span> <span id="coinSymbol">BTC</span></span>
                            <span class="fee">Network Fee: ~<span id="networkFee">0.0005</span> <span id="feeSymbol">BTC</span></span>
                        </div>
                    </div>
                    
                    <button id="withdrawSubmitBtn" class="submit-btn">Withdraw Now</button>
                </div>
            </div>
        </div>
    </div>

    <div id="swapModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Swap Crypto</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form">
                    <div class="swap-container">
                        <div class="swap-from">
                            <div class="swap-input-group">
                                <div class="coin-selector">
                                    <select id="fromCoin" class="form-select">
                                        <option value="btc">BTC</option>
                                        <option value="eth">ETH</option>
                                        <option value="orx">ORX</option>
                                    </select>
                                </div>
                                <input type="number" id="fromAmount" class="form-input" placeholder="0.00" min="0" step="any">
                            </div>
                            <div class="amount-details">
                                <span class="available">Available: <span id="fromAvailable">0.00</span> <span id="fromSymbol">BTC</span></span>
                            </div>
                        </div>
                        
                        <div class="swap-arrows">
                            <button id="swapDirectionBtn"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                        
                        <div class="swap-to">
                            <div class="swap-input-group">
                                <div class="coin-selector">
                                    <select id="toCoin" class="form-select">
                                        <option value="eth">ETH</option>
                                        <option value="btc">BTC</option>
                                        <option value="orx">ORX</option>
                                    </select>
                                </div>
                                <input type="number" id="toAmount" class="form-input" placeholder="0.00" min="0" step="any" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="swap-details">
                        <div class="detail-item">
                            <span class="detail-label">Exchange Rate</span>
                            <span id="exchangeRate" class="detail-value">1 BTC = 13.54 ETH</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Fee</span>
                            <span id="swapFee" class="detail-value">0.1%</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Est. Arrival</span>
                            <span class="detail-value">~2 minutes</span>
                        </div>
                    </div>
                    
                    <button id="swapSubmitBtn" class="submit-btn">Swap Now</button>
                </div>
            </div>
        </div>
    </div>

    <div id="historyModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Transaction History</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="history-filters">
                    <div class="filter-group">
                        <label for="historyType">Type</label>
                        <select id="historyType" class="form-select">
                            <option value="all">All Transactions</option>
                            <option value="deposit">Deposits</option>
                            <option value="withdraw">Withdrawals</option>
                            <option value="swap">Swaps</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="historyCoin">Coin</label>
                        <select id="historyCoin" class="form-select">
                            <option value="all">All Coins</option>
                            <option value="btc">Bitcoin (BTC)</option>
                            <option value="eth">Ethereum (ETH)</option>
                            <option value="orx">Orionix (ORX)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="historyDateRange">Period</label>
                        <select id="historyDateRange" class="form-select">
                            <option value="week">Last 7 days</option>
                            <option value="month">Last 30 days</option>
                            <option value="year">Last year</option>
                            <option value="all">All time</option>
                        </select>
                    </div>
                </div>
                
                <div class="extended-transactions-list">
                </div>
                
                <div class="history-pagination">
                    <button class="pagination-btn prev" disabled><i class="fas fa-chevron-left"></i></button>
                    <span class="pagination-info">Page 1 of 1</span>
                    <button class="pagination-btn next" disabled><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    
    <script src="../script.js"></script>
    <script src="js/wallet.js"></script>
    
    <div id="cardDetailsModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Card Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form">
                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" id="cardNumber" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="cardExpiry">Expiration Date</label>
                            <input type="text" id="cardExpiry" class="form-input" placeholder="MM/YY" maxlength="5">
                        </div>
                        <div class="form-group half">
                            <label for="cardCVV">CVV</label>
                            <input type="text" id="cardCVV" class="form-input" placeholder="123" maxlength="3">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cardName">Name on Card</label>
                        <input type="text" id="cardName" class="form-input" placeholder="John Doe">
                    </div>
                    
                    <div class="transaction-preview-card">
                        <h4 class="preview-title">Payment Summary</h4>
                        <div class="preview-content">
                            <div class="preview-row">
                                <span class="preview-label">Amount:</span>
                                <span class="preview-value">$<span id="cardPaymentAmount">0.00</span></span>
                            </div>
                            <div class="preview-row">
                                <span class="preview-label">Crypto:</span>
                                <span class="preview-value"><span id="cardPaymentCrypto">0.00</span> <span id="cardPaymentSymbol">BTC</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <button id="processPaymentBtn" class="submit-btn">Process Payment</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="paymentConfirmationModal" class="wallet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Payment Successful</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="confirmation-content">
                    <div class="confirmation-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4>Transaction Completed!</h4>
                    <p>Your payment has been processed successfully.</p>
                    <p>Crypto will be added to your wallet shortly.</p>
                    <div class="confirmation-details">
                        <div class="detail-row">
                            <span class="detail-label">Amount:</span>
                            <span class="detail-value">$<span id="confirmationAmount">0.00</span></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Crypto:</span>
                            <span class="detail-value"><span id="confirmationCrypto">0.00</span> <span id="confirmationSymbol">BTC</span></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Transaction ID:</span>
                            <span class="detail-value" id="confirmationTxId">TX123456789</span>
                        </div>
                    </div>
                    <button id="confirmationDoneBtn" class="submit-btn">Done</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 