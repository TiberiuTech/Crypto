<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orionix Token - Crypto-Platform</title>
    <script>
      (function() {
        try { 
          const savedTheme = localStorage.getItem('theme');
          const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          const theme = savedTheme || (prefersDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
        } catch (e) {
          console.warn('Could not apply theme from localStorage', e);
        }
      })();
    </script>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <a href="../index.html" class="logo">Crypto-Platform</a>
        <button class="hamburger">
            <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links">
            <a href="news.html" class="nav-item">News</a>
            <a href="prices.html" class="nav-item">Prices</a>
            <a href="orionix.html" class="nav-item active">Orionix</a>
            <a href="wallet.html" class="nav-item">Wallet</a>
            <a href="trade.html" class="nav-item">Trade</a>
            <button id="themeToggleBtnMobile" class="theme-toggle-btn mobile">
                <i class="fas fa-moon"></i>
            </button>
        </div>
        <div class="controls-desktop">
            <button id="notificationBtn" class="notification-btn">
                <i class="fas fa-bell"></i>
                <span class="alert-badge"></span>
            </button>
            <button id="themeToggleBtn" class="theme-toggle-btn">
                <i class="fas fa-moon"></i>
            </button>
            <div class="auth-buttons desktop" style="display:flex; gap:0.5rem;">
                <button id="loginBtn" class="auth-btn" onclick="window.location.href='login.html'">Login</button>
                <button id="signupBtn" class="auth-btn" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
            <div id="user-info-desktop" class="user-info-desktop" style="display:none; align-items:center; gap:10px;">
                <img id="user-photo-desktop" src="" alt="User Photo" style="width:32px;height:32px;border-radius:50%;object-fit:cover;display:none;">
                <span id="user-name-desktop" style="font-weight:600;"></span>
                <button id="logoutBtnDesktop" class="auth-btn" style="display:none;">Logout</button>
            </div>
        </div>
    </nav>

    <section class="orionix-section">
        <div class="container">
            <div class="about-orionix">
                <h2>About Orionix</h2>
                <p>Orionix (ORX) este un token ERC-20 inovativ, dezvoltat pentru a oferi o experiență de tranzacționare rapidă, sigură și eficientă în ecosistemul Ethereum. Bazat pe tehnologia blockchain, ORX asigură transparență completă și imuabilitate pentru toate tranzacțiile.</p>
                <p>Dezvoltat cu un focus pe scalabilitate și eficiență energetică, Orionix utilizează un mecanism de consens optimizat care reduce semnificativ costurile de tranzacționare și timpul de procesare. Toate tranzacțiile sunt verificate prin contracte inteligente, eliminând nevoia de intermediari și asigurând securitatea fondurilor utilizatorilor.</p>
                <p>Având o ofertă inițială limitată de 1,000,000 ORX, tokenul nostru este conceput pentru a-și păstra valoarea pe termen lung. Deținătorii de ORX beneficiază de taxe reduse pe platformă, acces la funcționalități exclusive și posibilitatea de a participa la guvernanța protocolului prin votarea propunerilor de îmbunătățire.</p>
            </div>
            
            <div class="token-details">
                <div class="detail-card">
                    <h3>Informații Generale</h3>
                    <div class="detail-row">
                        <span>Nume:</span>
                        <span>Orionix</span>
                    </div>
                    <div class="detail-row">
                        <span>Simbol:</span>
                        <span>ORX</span>
                    </div>
                    <div class="detail-row">
                        <span>Standard:</span>
                        <span>ERC-20</span>
                    </div>
                    <div class="detail-row">
                        <span>Decimale:</span>
                        <span>18</span>
                    </div>
                    <div class="detail-row">
                        <span>Supply inițial:</span>
                        <span>1,000,000 ORX</span>
                    </div>
                    <div class="detail-row">
                        <span>Rețea:</span>
                        <span>Sepolia Testnet</span>
                    </div>
                    <div class="detail-row contract-address">
                        <span>Adresă Contract:</span>
                        <span id="contract-address">Se încarcă...</span>
                    </div>
                    <div class="detail-row">
                        <span>Stare Contract:</span>
                        <span id="contract-status">Se verifică...</span>
                    </div>
                </div>
                
                <div class="wallet-info-card">
                    <h3>Portofelul Tău</h3>
                    <div class="wallet-connect">
                        <button id="connect-wallet-btn" class="connect-btn">Conectează MetaMask</button>
                        <div id="load-error-message" class="error-message" style="display: none; margin-top: 10px; padding: 8px 12px; background-color: rgba(220, 53, 69, 0.1); color: #dc3545; border-radius: 6px; text-align: center; font-size: 0.9rem;">
                            <i class="fas fa-exclamation-circle"></i> 
                            Nu s-a putut încărca biblioteca ethers.js. <a href="#" id="show-details-btn" style="color: #dc3545; text-decoration: underline;">Afișează detalii</a>
                        </div>
                    </div>
                    <div class="wallet-details">
                        <div class="detail-row">
                            <span>Adresă:</span>
                            <span id="wallet-address">Neconectat</span>
                        </div>
                        <div class="detail-row">
                            <span>Sold ORX:</span>
                            <span id="token-balance">0 ORX</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="token-actions" style="display: flex; justify-content: center; width: 100%; margin: 2rem 0;">
                <div class="action-card" style="max-width: 500px; width: 100%;">
                    <h3>Transfer Tokeni</h3>
                    <div class="form-group">
                        <label for="recipient-address">Adresa Destinatarului:</label>
                        <input type="text" id="recipient-address" placeholder="0x...">
                    </div>
                    <div class="form-group">
                        <label for="transfer-amount">Cantitate:</label>
                        <div class="amount-input">
                            <input type="number" id="transfer-amount" min="0" step="0.01">
                            <span>ORX</span>
                        </div>
                    </div>
                    <button id="transfer-btn" class="action-btn">Transferă Tokeni</button>
                    <div id="transfer-status" class="status-message"></div>
                </div>
            </div>
            
            <div class="transaction-history">
                <h3>Istoricul Tranzacțiilor</h3>
                <div class="transaction-list" id="transaction-list">
                    <div class="empty-state">
                        Conectează-ți portofelul pentru a vedea tranzacțiile tale.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Firebase Scripts -->
    <!-- Implementare simplificată pentru autentificare -->
    <script src="js/firebase-config.js"></script>
    
    <script src="../script.js"></script>
    <script src="../Orionix/orionix-interface.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inițializăm managerul pentru tokenul Orionix
            if (typeof OrionixTokenManager !== 'undefined') {
                const tokenManager = new OrionixTokenManager();
                window.orionixToken = tokenManager; // Expunem managerul global pentru acces ușor
                
                // Actualizăm interfața inițial (adresa contractului și starea acestuia)
                tokenManager.updateUI();
                
                // Adăugăm event listener pentru butonul de conectare
                const connectWalletBtn = document.getElementById('connect-wallet-btn');
                if (connectWalletBtn) {
                    connectWalletBtn.addEventListener('click', async function() {
                        try {
                            connectWalletBtn.textContent = 'Se conectează...';
                            connectWalletBtn.disabled = true;
                            connectWalletBtn.classList.add('loading');
                            
                            await tokenManager.connect();
                            
                            connectWalletBtn.textContent = 'Portofel Conectat';
                            connectWalletBtn.classList.remove('loading');
                            connectWalletBtn.classList.add('connected');
                            document.querySelector('.empty-state').textContent = 'Nu există tranzacții recente.';
                            
                            // Ascundem mesajul de eroare dacă era afișat
                            document.getElementById('load-error-message').style.display = 'none';
                        } catch (error) {
                            console.error(error);
                            
                            // Afișăm mesaj de eroare potrivit pentru utilizator
                            connectWalletBtn.textContent = 'Conectează MetaMask';
                            connectWalletBtn.disabled = false;
                            connectWalletBtn.classList.remove('loading');
                            connectWalletBtn.classList.remove('connected');
                            
                            let errorMessage = 'Eroare de conectare';
                            
                            if (error.message.includes('MetaMask nu este instalat')) {
                                errorMessage = 'MetaMask nu este instalat';
                                window.showCenterAlert('Pentru a continua, instalați extensia MetaMask și creați un portofel.');
                            } else if (error.message.includes('ethers.js')) {
                                errorMessage = 'Eroare bibliotecă';
                                // Afișăm mesajul de eroare special
                                document.getElementById('load-error-message').style.display = 'block';
                                
                                window.showCenterAlert(`
                                    Nu s-a putut încărca biblioteca necesară. Posibile soluții:
                                    <br><br>1. Verificați conexiunea la internet
                                    <br>2. Dezactivați Ad-Blocker sau alte extensii care blochează scripturile
                                    <br>3. Folosiți un browser actualizat (Chrome, Firefox, Edge)
                                    <br>4. Reîncărcați pagina și încercați din nou
                                `, true);
                            } else if (error.code === 4001) {
                                // User a respins conectarea
                                errorMessage = 'Conectare respinsă';
                                window.showCenterAlert('Ați respins conectarea la MetaMask. Pentru a continua, trebuie să vă conectați portofelul.');
                            } else {
                                window.showCenterAlert(`
                                    A apărut o eroare la conectare: ${error.message || 'Eroare necunoscută'}. 
                                    <br><br>Verificați consola pentru detalii.
                                    <br><br>Încercați să reîmprospătați pagina și să verificați dacă MetaMask este configurat corect.
                                `, true);
                            }
                            
                            document.getElementById('wallet-address').textContent = errorMessage;
                        }
                    });
                    
                    // Adăugăm event listener pentru butonul "Afișează detalii"
                    const showDetailsBtn = document.getElementById('show-details-btn');
                    if (showDetailsBtn) {
                        showDetailsBtn.addEventListener('click', function(e) {
                            e.preventDefault();
                            window.showCenterAlert(`
                                Nu s-a putut încărca biblioteca necesară. Posibile soluții:
                                <br><br>1. Verificați conexiunea la internet
                                <br>2. Dezactivați Ad-Blocker sau alte extensii care blochează scripturile
                                <br>3. Folosiți un browser actualizat (Chrome, Firefox, Edge)
                                <br>4. Reîncărcați pagina și încercați din nou
                            `, true);
                        });
                    }
                }
            }
        });
    </script>
</body>
</html>