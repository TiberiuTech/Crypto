<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - Crypto-Platform</title>
     <script>
      (function() {
        try { 
          const savedTheme = localStorage.getItem('theme');
          const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          const theme = savedTheme || (prefersDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
        } catch (e) {
          console.warn('Could not apply theme from localStorage', e);
        }
      })();
    </script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="logo">Crypto-Platform</a>
        <button class="hamburger">
            <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links">
            <a href="news.html" class="nav-item">News</a>
            <a href="#" class="nav-item">Prices</a>
            <a href="#" class="nav-item">Orionix</a>
            <a href="#" class="nav-item">Trade</a>
            <div class="auth-buttons mobile">
                <button id="loginBtnMobile" class="auth-btn" onclick="window.location.href='login.html'">Login</button>
                <button id="signupBtnMobile" class="auth-btn" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
            <button id="themeToggleBtnMobile" class="theme-toggle-btn mobile">
                <i class="fas fa-moon"></i>
            </button>
        </div>
        <div class="controls-desktop">
            <button id="themeToggleBtn" class="theme-toggle-btn">
                <i class="fas fa-moon"></i>
            </button>
            <div class="auth-buttons desktop">
                <button id="loginBtn" class="auth-btn" onclick="window.location.href='login.html'">Login</button>
                <button id="signupBtn" class="auth-btn" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
        </div>
    </nav>

    <main class="form-page-container">
        <div class="form-container">
            <h1 class="form-title">Reset Password</h1>
            <p class="form-description">Enter your new password below.</p>
            <form id="reset-password-form">
                 <!-- Hidden input to potentially store the token from URL -->
                <input type="hidden" id="reset-token" name="token" value="">
                
                <div class="form-group">
                    <label for="reset-new-password">New Password</label>
                    <div class="password-input-container">
                        <input type="password" id="reset-new-password" name="newPassword" required>
                        <i class="fas fa-eye password-toggle-icon" id="toggle-reset-password"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label for="reset-confirm-password">Confirm New Password</label>
                     <div class="password-input-container">
                        <input type="password" id="reset-confirm-password" name="confirmNewPassword" required>
                        <i class="fas fa-eye password-toggle-icon" id="toggle-reset-confirm-password"></i>
                    </div>
                </div>
                <button type="submit" class="form-submit-btn">Reset Password</button>
            </form>
            <p id="reset-message" class="form-message"></p> <!-- For success/error messages -->
            <p class="form-switch-link"><a href="login.html">Back to Login</a></p>
        </div>
    </main>

    <script src="script.js"></script> 
    <script>
        // Basic JS simulation for reset password form
        const resetForm = document.getElementById('reset-password-form');
        const resetMessage = document.getElementById('reset-message');
        const tokenInput = document.getElementById('reset-token');

        // Try to get token from URL (replace with actual backend logic)
        try {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            if (token && tokenInput) {
                tokenInput.value = token;
                console.log('Token found in URL:', token);
            } else {
                 console.log('No token found in URL.');
                 // Optionally redirect or show error if no token
                 // resetMessage.textContent = 'Invalid or missing password reset token.';
                 // resetMessage.style.color = 'red';
            }
        } catch (e) {
             console.error('Error reading token from URL:', e);
        }

        if (resetForm && resetMessage) {
            resetForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newPassword = document.getElementById('reset-new-password').value;
                const confirmPassword = document.getElementById('reset-confirm-password').value;
                const token = tokenInput ? tokenInput.value : ''; // Get token from hidden input

                resetMessage.textContent = 'Processing...';
                resetMessage.style.color = 'var(--text-secondary)';

                if (newPassword !== confirmPassword) {
                    resetMessage.textContent = 'Passwords do not match.';
                    resetMessage.style.color = 'red';
                    return;
                }
                if (newPassword.length < 6) { // Example validation
                     resetMessage.textContent = 'Password must be at least 6 characters long.';
                     resetMessage.style.color = 'red';
                     return;
                }
                if (!token) { // Check if token is present
                    resetMessage.textContent = 'Invalid or missing password reset token.';
                    resetMessage.style.color = 'red';
                    return;
                }

                // Simulate API call
                setTimeout(() => {
                    console.log('Simulating password reset for token:', token, 'with new password:', newPassword);
                    resetMessage.textContent = 'Password has been successfully reset. You can now login.';
                    resetMessage.style.color = 'green';
                    resetForm.reset(); 
                    // Optionally redirect to login after a delay
                    // setTimeout(() => { window.location.href = 'login.html'; }, 2000);
                }, 1500);
            });
        }
        
        // Setup password toggles for this page too
        setupPasswordToggle('reset-new-password', 'toggle-reset-password');
        setupPasswordToggle('reset-confirm-password', 'toggle-reset-confirm-password');
    </script>
</body>
</html> 